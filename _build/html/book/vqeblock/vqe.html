
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Variational Quantum Eigensolver &#8212; QMLCourse</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://semyonsinchenko.github.io/qmlcourse/_build/html/book/index.html/book/vqeblock/vqe.html" />
    <link rel="shortcut icon" href="../../_static/qmlcourse_favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é VQE" href="tspvqe.html" />
    <link rel="prev" title="–û –±–ª–æ–∫–µ" href="vqeintro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">QMLCourse</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–≤–µ–¥–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro1block/intro1.html">
   üü¶ –û –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../prerequisite.html">
   ‚¨ú –ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫—É—Ä—Å–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/pythonintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l1.html">
   üü¶ –í–≤–æ–¥–Ω–∞—è –ª–µ–∫—Ü–∏—è –ø—Ä–æ Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l2.html">
   üü¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/jupyter_l3.html">
   üü¶ –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –≤ Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l4.html">
   üü¶ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∏–ø—ã –∏ –≤—ã–≤–æ–¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l5.html">
   üü¶ –£—Å–ª–æ–≤–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l6.html">
   üü¶ –°–ø–∏—Å–∫–∏ –∏ —Ü–∏–∫–ª—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l7.html">
   üü¶ –°–ª–æ–≤–∞—Ä–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l8.html">
   üü¶ –§—É–Ω–∫—Ü–∏–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l9.html">
   üü¶ –û–±—ä–µ–∫—Ç—ã –∏ –∫–ª–∞—Å—Å—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l10.html">
   üü¶ –§–∏–Ω–∞–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –õ–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞ –∏ numpy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/numpy.html">
   üü¶ Numpy fun
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_l1.html">
   üü¶ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∫–∞–∫ –ø–∞–∑–ª
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qubit.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±–∏—Ç
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/gates.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥–µ–π—Ç—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –§—Ä–µ–π–º–≤–æ—Ä–∫–∏
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/progintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/pennylane.html">
   üü© PennyLane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/tfq.html">
   üüß Cirq &amp; TFQ
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ë–∞–∑–æ–≤—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/qcalgointro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_algorithms_overview.html">
   üü© –û–±–∑–æ—Ä –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/deutschs_algorithm.html">
   üü© –ê–ª–≥–æ—Ä–∏—Ç–º –î–æ–π—á–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_teleportation.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/grovers_algorithm.html">
   üüß –ê–ª–≥–æ—Ä–∏—Ç–º –ì—Ä–æ–≤–µ—Ä–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ñ–µ–ª–µ–∑–æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwreview.html">
   üü© –û–±–∑–æ—Ä
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/scqubits.html">
   üü• –°–≤–µ—Ä—Ö–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤—ã–µ –∫—É–±–∏—Ç—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qmlkindsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/hhl_algorithm.html">
   üü• –ê–ª–≥–æ—Ä–∏—Ç–º HHL
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqc.html">
   üü© –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradients.html">
   üü© –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å—Ö–µ–º
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/hogradients.html">
   üüß –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–π SVM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/qsvmintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/hybridsvm.html">
   üü© –ì–∏–±—Ä–∏–¥–Ω—ã–π SVM
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qnnblock/qnnintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qnnblock/qconv.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–µ—Ç–∏
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ü—Ä–æ–±–ª–µ–º—ã –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/problemsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchembasic.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (–í–≤–µ–¥–µ–Ω–∏–µ)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchemadvancedscf.html">
   üüß –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (SCF)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/ising.html">
   üü© –ú–æ–¥–µ–ª—å –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/copt.html">
   üü© –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Ç –ø—Ä–æ–±–ª–µ–º –∫ –æ–±—É—á–µ–Ω–∏—é
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/problems2qmlintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/np2ising.html">
   üü© NP –∫–∞–∫ –º–æ–¥–µ–ª–∏ –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/eigenvals.html">
   üü© –û —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  VQE
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vqeintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   üü© –û—Å–Ω–æ–≤—ã VQE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tspvqe.html">
   üü© TSP —Å –ø–æ–º–æ—â—å—é VQE
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û –∫—É—Ä—Å–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../authors.html">
   –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ –∫—É—Ä—Å–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgments.html">
   –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   –ì–ª–æ—Å—Å–∞—Ä–∏–π
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/book/vqeblock/vqe.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/book/vqeblock/vqe.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/SemyonSinchenko/qmlcourse"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/SemyonSinchenko/qmlcourse/issues/new?title=Issue%20on%20page%20%2Fbook/vqeblock/vqe.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/SemyonSinchenko/qmlcourse/master?urlpath=tree/qmlcourseRU/book/vqeblock/vqe.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   –ó–∞–¥–∞—á–∞ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     –ê–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     –°—Ç–µ–ø–µ–Ω–Ω–æ–π –º–µ—Ç–æ–¥
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     –ò—Ç–µ—Ä–∞—Ü–∏—è –ê—Ä–Ω–æ–ª—å–¥–∏
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   VQE
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é VQE
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     –°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tsp-networkx">
     –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ TSP –≤ NetworkX
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sigma-z-mod">
     –ú–∞—Ç—Ä–∏—Ü–∞
     <span class="math notranslate nohighlight">
      \(\sigma^z_{mod}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vqe-pennylane">
       VQE –Ω–∞ Pennylane
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id14">
   –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="variational-quantum-eigensolver">
<span id="vqe"></span><h1>Variational Quantum Eigensolver<a class="headerlink" href="#variational-quantum-eigensolver" title="Permalink to this headline">¬∂</a></h1>
<p>–í —ç—Ç–æ–π –ª–µ–∫—Ü–∏–∏ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∞–∫–æ–π –∫–ª–∞—Å—Å–Ω—ã–π –∏ –æ—á–µ–Ω—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∫–∞–∫ <code class="docutils literal notranslate"><span class="pre">Variational</span> <span class="pre">Quantum</span> <span class="pre">Eigensolver</span></code>. –≠—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–Ω –¥–ª—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –º–∞—Ç—Ä–∏—Ü. –ù–æ, –∫–∞–∫ –º—ã —É–≤–∏–¥–∏–º, –∫ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ —Ä–µ–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∑–∞–¥–∞—á, –Ω–∞–ø—Ä–∏–º–µ—Ä, <em>NP</em>-—Ç—Ä—É–¥–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –æ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∏ –≤ <a class="reference internal" href="../qcalgo/quantum_algorithms_overview.html#quantum-algorithms-overview"><span class="std std-ref">–ª–µ–∫—Ü–∏–∏ –æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö</span></a>.</p>
<p>–õ–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<ul class="simple">
<li><p>–ö—Ä–∞—Ç–∫–æ –≤—Å–ø–æ–º–Ω–∏–º –∑–∞–¥–∞—á—É –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö</p></li>
<li><p>–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —ç—Ç—É –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–º—É —Å–ø—É—Å–∫—É –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ <a class="reference internal" href="../vqcblock/vqc.html#vqc"><span class="std std-ref">–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–≤–∞–Ω—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã</span></a></p></li>
<li><p>–ü–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–æ–º, —á—Ç–æ —Ç–∞–∫–æ–µ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω –ò–∑–∏–Ω–≥–∞</p></li>
<li><p>–£–≤–∏–¥–∏–º, –∫–∞–∫ –∑–∞–¥–∞—á–∏ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–≤–æ–¥—è—Ç—Å—è –∫ –ø—Ä–æ–±–ª–µ–º–µ –ò–∑–∏–Ω–≥–∞</p></li>
<li><p>–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑—É–µ–º <code class="docutils literal notranslate"><span class="pre">VQE</span></code> –∏ —Ä–µ—à–∏–º –º–∞–ª–µ–Ω—å–∫—É—é –∑–∞–¥–∞—á–∫—É –ö–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞</p></li>
</ul>
<div class="section" id="id1">
<h2>–ó–∞–¥–∞—á–∞ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h2>
<p>–¢–µ–º, –∫–æ–º—É —ç—Ç–æ—Ç –±–ª–æ–∫ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∂–µ—Ç—Å—è —Ç—Ä—É–¥–Ω—ã–º, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤–≤–æ–¥–Ω—ã–º –ª–µ–∫—Ü–∏—è–º –ø–æ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ, –∞ –∏–º–µ–Ω–Ω–æ –∫ <span class="xref myst">—á–∞—Å—Ç–∏ –ø—Ä–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞ –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>.</p>
<p>–ò—Ç–∞–∫, –ø—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –¥–∏–∞–≥–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–∞—è –º–∞—Ç—Ä–∏—Ü–∞ <span class="math notranslate nohighlight">\(A\)</span> —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ <span class="math notranslate nohighlight">\(n \times n\)</span>, –æ–Ω–∞ –∂–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º <span class="math notranslate nohighlight">\(\hat{A}\)</span>. –ò–∑ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ —É —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã –µ—Å—Ç—å <span class="math notranslate nohighlight">\(n\)</span> —Ç–∞–∫–∏—Ö —á–∏—Å–µ–ª <span class="math notranslate nohighlight">\(e_i\)</span> –∏ —Ç–∞–∫–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ <span class="math notranslate nohighlight">\(\Psi_i\)</span>, —á—Ç–æ –¥–ª—è –Ω–∏—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ:</p>
<div class="math notranslate nohighlight">
\[
A \Psi_i = e_i \Psi_i
\]</div>
<p>–∏–ª–∏ –≤ –Ω–æ—Ç–∞—Ü–∏–∏ –î–∏—Ä–∞–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π:</p>
<div class="math notranslate nohighlight">
\[
\hat{A} \ket{\Psi_i} = e_i\ket{\Psi_i}
\]</div>
<p>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞ ‚Äì —ç—Ç–æ —Ç–∞–∫–∏–µ –≤–µ–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –º–µ–Ω—è—é—Ç —Å–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä ‚Äì —ç—Ç–æ –æ—Å—å —Å–∏–º–º–µ—Ç—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:</p>
<div class="figure align-default" id="mona-lisa-eigen">
<a class="reference internal image-reference" href="../../_images/Mona_Lisa.png"><img alt="../../_images/Mona_Lisa.png" src="../../_images/Mona_Lisa.png" style="width: 450px;" /></a>
<p class="caption"><span class="caption-number">Fig. 98 </span><span class="caption-text">–°–∏–Ω–∏–π –≤–µ–∫—Ç–æ—Ä, –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –∫—Ä–∞—Å–Ω–æ–≥–æ, –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –º–µ–Ω—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–∫ –∫–∞–∫ —è–≤–ª—è–µ—Ç—Å—è –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º.</span><a class="headerlink" href="#mona-lisa-eigen" title="Permalink to this image">¬∂</a></p>
</div>
<div class="section" id="id2">
<h3>–ê–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h3>
<p>–í —Ü–µ–ª–æ–º, –∑–∞–¥–∞—á–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —è–≤–ª—è–µ—Ç—Å—è –æ—á–µ–Ω—å —Ç—Ä—É–¥–Ω–æ–π —Å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Ç—Ä–∏—Ü. –î–ª—è –º–∞—Ç—Ä–∏—Ü —Ä–∞–∑–º–µ—Ä–∞ –±–æ–ª–µ–µ, —á–µ–º <span class="math notranslate nohighlight">\(3 \times 3\)</span> –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤. –û–¥–Ω–∞–∫–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ª–∏—à—å –¥–≤–∞ –∏–∑ –Ω–∏—Ö, –ø—Ä–∏—á–µ–º –±–µ–∑ –æ—Å–æ–±—ã—Ö –¥–µ—Ç–∞–ª–µ–π, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –∞ —Ç–∞–∫–∂–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏—Ö —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —è–≤–ª—è—é—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–ª–æ–∂–Ω—ã–º–∏.</p>
</div>
<div class="section" id="id3">
<h3>–°—Ç–µ–ø–µ–Ω–Ω–æ–π –º–µ—Ç–æ–¥<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h3>
<p>–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–π, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è. –°—É—Ç—å –µ–≥–æ –≤ —Ç–æ–º, —á—Ç–æ –º—ã –±–µ—Ä–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤–µ–∫—Ç–æ—Ä <span class="math notranslate nohighlight">\(\ket{\Psi}\)</span> –∏ –Ω–∞—á–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º <span class="math notranslate nohighlight">\(\hat{A}\)</span> (–¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ —É–º–Ω–æ–∂–∞—Ç—å, –Ω–∞ –Ω–∞—à—É –º–∞—Ç—Ä–∏—Ü—É), –ø—Ä–∏ —ç—Ç–æ–º –Ω–æ—Ä–º–∏—Ä—É—è:</p>
<div class="math notranslate nohighlight">
\[
\ket{\Psi_{i+1}} = \frac{\hat{A}\ket{\Psi_i}}{||\hat{A}||}
\]</div>
<p>–ò —Ç–∞–∫ –º—ã –ø–æ–≤—Ç–æ—Ä—è–µ–º –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –Ω–µ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ, —á–µ–º –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –∑–∞–¥–∞–Ω–Ω–æ–µ –º–∞–ª–µ–Ω—å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <span class="math notranslate nohighlight">\(\epsilon\)</span>. –ö–æ–≥–¥–∞ –º—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —ç—Ç–æ–≥–æ —É—Å–ª–æ–≤–∏—è, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –º—ã –Ω–∞—à–ª–∏ –ø–µ—Ä–≤—ã–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é. –í —á–∞—Å—Ç–Ω–æ–º —Å–ª—É—á–∞–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –Ω–∞–º —ç—Ä–º–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –º–æ–∂–Ω–æ —Ç–∞–∫ –∂–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –≤—Å–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞ –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –Ω–∞—à–∞ —Å–µ—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –≥—Ä–∞—Ñ–æ–º ‚Äì –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π –≤–µ—Ä—à–∏–Ω. –ê –ª—é–±–æ–π –≥—Ä–∞—Ñ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –≤–∏–¥–µ –±–æ–ª—å—à–æ–π-–±–æ–ª—å—à–æ–π, –Ω–æ –æ—á–µ–Ω—å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∫–æ—Ç–æ—Ä–æ–π —ç—Ç–æ 1 –µ—Å–ª–∏ –º–µ–∂–¥—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –≤–µ—Ä—à–∏–Ω–∞–º–∏ –µ—Å—Ç—å —Ä–µ–±—Ä–æ –∏ 0, –µ—Å–ª–∏ –Ω–µ—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, —ç–ª–µ–º–µ–Ω—Ç <span class="math notranslate nohighlight">\(L_{ij}\)</span> –±—É–¥–µ—Ç 1, –µ—Å–ª–∏ –º–µ–∂–¥—É –≤–µ—Ä—à–∏–Ω–∞–º–∏ <span class="math notranslate nohighlight">\(i\)</span> –∏ <span class="math notranslate nohighlight">\(j\)</span> –µ—Å—Ç—å —Ä–µ–±—Ä–æ. –í 1998-–º –≥–æ–¥—É, –õ–∞—Ä—Ä–∏ –ü–µ–π–¥–∂ –∏ –°–µ—Ä–≥–µ–π –ë—Ä–∏–Ω –Ω–∞—à–ª–∏ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–¥—Å—á–µ—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—è –∏–º–µ–Ω–Ω–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é —Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞. –≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–ª—É—á–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ <code class="docutils literal notranslate"><span class="pre">PageRank</span></code>, –ø—Ä–∏—á–µ–º <em>Page</em> —ç—Ç–æ —Ñ–∞–º–∏–ª–∏—è –∞–≤—Ç–æ—Ä–∞, –∞ –Ω–µ –æ—Ç—Å—ã–ª–∫–∞ –∫ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞–º, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–æ–¥—É–º–∞—Ç—å. –≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ª–µ–≥ –≤ –æ—Å–Ω–æ–≤—É –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞ <em>Google</em>, –∫–æ—Ç–æ—Ä—ã–π –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –≤—ã—Ä–æ—Å –≤ —Ç—Ä–∞–Ω—Å–Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏—é!</p>
</div>
</div>
<div class="section" id="id4">
<h3>–ò—Ç–µ—Ä–∞—Ü–∏—è –ê—Ä–Ω–æ–ª—å–¥–∏<a class="headerlink" href="#id4" title="Permalink to this headline">¬∂</a></h3>
<p>–≠—Ç–æ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π, –æ–¥–Ω–∞–∫–æ, —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º –º–∞—Ç—Ä–∏—Ü–∞–º <span id="id5">[<a class="reference internal" href="../bibliography.html#id14"><span>Arn51</span></a>]</span>. –û–±—ä—è—Å–Ω–∏—Ç—å –µ–≥–æ –ª–µ–≥–∫–æ, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º —Ç—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –ö—Ä—ã–ª–æ–≤—Å–∫–∏—Ö –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ù–æ –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏—à—å —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –∏–º–µ–µ—Ç –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é ‚Äì <a class="reference external" href="https://www.caam.rice.edu/software/ARPACK/">ARPACK</a>, –Ω–∞–ø–∏—Å–∞–Ω–Ω—É—é –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ 90-—Ö –≥–æ–¥–æ–≤ –Ω–∞ —è–∑—ã–∫–µ <code class="docutils literal notranslate"><span class="pre">FORTRAN77</span></code>. –ò–º–µ–Ω–Ω–æ —ç—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚Äú–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º‚Äù —É <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>, –∞ —Ç–∞–∫–∂–µ –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –Ω–∞—É—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.</p>
<p>–°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–æ–ª—å—à—É—é —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">py</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="n">num_elements</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">px</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">spmat</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_elements</span><span class="p">),</span>
        <span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">num_elements</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">num_elements</span><span class="p">]))</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spmat</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>–ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–∞ <span class="math notranslate nohighlight">\(10000 \times 10000\)</span> —ç—Ç–æ –±–æ–ª—å—à–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–π –≤ ‚Äú–ø–ª–æ—Ç–Ω–æ–º‚Äù (dense) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –±—ã–ª–æ –±—ã –æ—á–µ–Ω—å —Ç—Ä—É–¥–Ω–æ. –ù–æ <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code> –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –¥–æ–ª–∏ —Å–µ–∫—É–Ω–¥, –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">sl</span>

<span class="n">max_eigval</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">spmat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;LR&quot;</span><span class="p">,</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">min_eigval</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">spmat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SR&quot;</span><span class="p">,</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min E: </span><span class="si">{</span><span class="n">min_eigval</span><span class="si">}</span><span class="se">\n</span><span class="s2">Max E: </span><span class="si">{</span><span class="n">max_eigval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–î–ª—è —Ç–µ—Ö –∫—Ç–æ –∑–∞–±—ã–ª, –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è <code class="docutils literal notranslate"><span class="pre">eigs</span></code> –∏–∑ <code class="docutils literal notranslate"><span class="pre">scipy.linalg.spare</span></code> –Ω–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —ç—Ç–æ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –≤—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä (<code class="docutils literal notranslate"><span class="pre">k</span></code>) —ç—Ç–æ —Ç–æ, —Å–∫–æ–ª—å–∫–æ –∏–º–µ–Ω–Ω–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å. –ü–∞—Ä–∞–º–µ—Ç—Ä <code class="docutils literal notranslate"><span class="pre">which</span></code> —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SM</span></code> ‚Äì <em>smallest magnitude</em> ‚Äì –Ω–∞–∏–º–µ–Ω—å—à–∏–µ –ø–æ –º–æ–¥—É–ª—é —á–∏—Å–ª–∞</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LM</span></code> ‚Äì <em>largest magnitude</em> ‚Äì –Ω–∞–∏–±–æ–ª—å—à–∏–µ –ø–æ –º–æ–¥—É–ª—é —á–∏—Å–ª–∞</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SR</span></code> ‚Äì <em>smallers real</em> ‚Äì —á–∏—Å–ª–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç—å—é</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LR</span></code> ‚Äì <em>largest real</em> ‚Äì —á–∏—Å–ª–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç—å—é</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SI</span></code> ‚Äì <em>smallest image</em> ‚Äì —á–∏—Å–ª–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –º–Ω–∏–º–æ–π —á–∞—Å—Ç—å—é</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LI</span></code> ‚Äì <em>largest image</em> ‚Äì —á–∞—Å–ª–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –º–Ω–∏–º–æ–π —á–∞—Å—Ç—å—é</p></li>
</ul>
<p>–ù–∞–∫–æ–Ω–µ—Ü, –ø–∞—Ä–∞–º–µ—Ç—Ä <code class="docutils literal notranslate"><span class="pre">return_eigenvectors</span></code> —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–º, —Ö–æ—Ç–∏–º –ª–∏ –º—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∏–ª–∏ –µ—â–µ –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞.</p>
<p>–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code>, –∞ —Ç–∞–∫–∂–µ —Å <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg</span></code> —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ [–≤–≤–æ–¥–Ω–æ–º –±–ª–æ–∫–µ –ø–æ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ](–ø–æ–∫–∞ –ø—É—Å—Ç–æ).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–ù–µ —É –≤—Å–µ—Ö –º–∞—Ç—Ä–∏—Ü –≤—Å–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏, –ø–æ—ç—Ç–æ–º—É <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code> –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—á–∏—Ç–∞–µ—Ç –Ω–∞–º –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Ö–æ—Ç—è –≤ —ç—Ç–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –º–Ω–∏–º–∞—è —á–∞—Å—Ç—å —Ä–∞–≤–Ω–∞ –Ω—É–ª—é.</p>
</div>
<p>–í –¥–∞–ª—å–Ω–µ–π—à–µ–º –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code>, –≤—ã–∑—ã–≤–∞—è –µ–≥–æ –∏–∑ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞—à –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–≤–∞–Ω—Ç–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—à–µ–ª –≤–µ—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏.</p>
</div>
</div>
<div class="section" id="id6">
<h2>VQE<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h2>
<p>–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —ç—Ç–∞ –∑–∞–¥–∞—á–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫ –µ–µ –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–º—É —Å–ø—É—Å–∫—É –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ <code class="docutils literal notranslate"><span class="pre">VQE</span></code>, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ª–∏—à—å –≥–µ–π—Ç—ã –≤—Ä–∞—â–µ–Ω–∏—è. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –Ω–∞–ª–∏—á–∏–µ –ª–∏—à—å –≥–µ–π—Ç–æ–≤ –≤—Ä–∞—â–µ–Ω–∏—è <a class="reference internal" href="../gradsblock/gradients.html#gradients"><span class="std std-ref">–ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å—á–∏—Ç–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã</span></a>.</p>
<div class="section" id="id7">
<h3>–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h3>
<p>–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å —ç—Ä–º–∏—Ç–æ–≤–∞ –º–∞—Ç—Ä–∏—Ü–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –º—ã —Ö–æ—Ç–∏–º –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –¢–æ –µ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code>, –Ω–æ –Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–ï—Å–ª–∏ –Ω–∞—à–∞ –º–∞—Ç—Ä–∏—Ü–∞ <span class="math notranslate nohighlight">\(A\)</span> –Ω–µ —ç—Ä–º–∏—Ç–æ–≤–∞, —Ç–æ –º—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç—å –µ–µ –¥–æ —ç—Ä–º–∏—Ç–æ–≤–æ–π. –ü–æ—ç—Ç–æ–º—É –¥–∞–ª–µ–µ, –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –æ–±—â–Ω–æ—Å—Ç–∏, –º—ã –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å —ç—Ç—É –º–∞—Ç—Ä–∏—Ü—É –∏–º–µ–Ω–Ω–æ —ç—Ä–º–∏—Ç–æ–≤–æ–π. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ —Ç–æ–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤ <span class="xref myst">–≤–≤–æ–¥–Ω—ã—Ö –ª–µ–∫—Ü–∏—è—Ö –ø–æ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ</span>. –ü–æ–∫–∞ –∂–µ –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.</p>
</div>
<p>–ò–∑ –ø–µ—Ä–≤—ã—Ö –ª–µ–∫—Ü–∏–π –º—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –ª—é–±–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤ –∫–∞–∫–æ–º-—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ <a class="reference external" href="../qcblock/qubit.html#id31">–µ—Å—Ç—å –ø—Ä–æ–µ–∫—Ü–∏—è —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤</a>, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏–∑–º–µ—Ä–µ–Ω–∏—è <a class="reference external" href="../qcblock/qubit.html#id25">—è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ –∏–∑ –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</a>. –ü—Ä–∏ —ç—Ç–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ–ª—É—á–µ–Ω–∏—è —ç—Ç–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞—à–µ–π –≤–æ–ª–Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π <span class="math notranslate nohighlight">\(\ket{\Psi}\)</span> –∏–∑–º–µ—Ä—è–µ–º–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ê –∑–Ω–∞—á–∏—Ç, —Ç–æ, –∫–∞–∫–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º—ã –ø–æ–ª—É—á–∏–º, –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è —Ç–µ–º, –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–º! –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –º—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏, –∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏–∑–º–µ—Ä–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ <span class="math notranslate nohighlight">\(\hat{A}\)</span> –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ <span class="math notranslate nohighlight">\(\ket{\Psi}\)</span> —Ç–∞–∫:</p>
<div class="math notranslate nohighlight">
\[
e = \bra{\Psi}\hat{A}\ket{\Psi}
\]</div>
<p>–ê, –∫–∞–∫ –º—ã –ø–æ–º–Ω–∏–º –∏–∑ <a class="reference internal" href="../vqcblock/vqc.html#vqc"><span class="std std-ref">–ª–µ–∫—Ü–∏–∏ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∫–≤–∞–Ω—Ç–æ–≤—ã–º —Å—Ö–µ–º–∞–º</span></a>, –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Å–∞–º–æ–π —Å—Ö–µ–º–æ–π (–µ—â–µ –≥–æ–≤–æ—Ä—è—Ç <em>ansatz</em>), –∞ —Ç–∞–∫–∂–µ –Ω–∞–±–æ—Ä–æ–º –µ–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.</p>
<p>–¢–∞–∫ –º—ã –ø—Ä–∏—Ö–æ–¥–∏–º –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É <code class="docutils literal notranslate"><span class="pre">VQE</span></code> ‚Äì <strong>V</strong>ariational <strong>Q</strong>uantum <strong>E</strong>igensolver:</p>
<ol class="simple">
<li><p>–í—ã–±–∏—Ä–∞–µ–º <em>ansatz</em> ‚Äì –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä <span class="math notranslate nohighlight">\(\hat{B}(q)\)</span>, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–µ–π—Ç–æ–≤ –≤—Ä–∞—â–µ–Ω–∏—è</p></li>
<li><p>–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã <span class="math notranslate nohighlight">\(q_0\)</span></p></li>
<li><p>–¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è, –ø–æ–≤—Ç–æ—Ä—è–µ–º <span class="math notranslate nohighlight">\(n\)</span> —Ä–∞–∑</p>
<ol class="simple">
<li><p>–ì–æ—Ç–æ–≤–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ <span class="math notranslate nohighlight">\(\ket{\Psi} = \hat{B}(q_n)\ket{0}\)</span></p></li>
<li><p>–ò–∑–º–µ—Ä—è–µ–º <span class="math notranslate nohighlight">\(e = \bra{\Psi}\hat{A}\ket{\Psi}\)</span></p></li>
<li><p>–í—ã—á–∏—Å–ª—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç <span class="math notranslate nohighlight">\(g = \frac{\partial{e}}{\partial{q}}\)</span></p></li>
<li><p>–û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã <span class="math notranslate nohighlight">\(q_{n+1} = q_n - \alpha g\)</span></p></li>
</ol>
</li>
<li><p>–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ–±—É—á–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è:</p>
<ul class="simple">
<li><p>–ù–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ <span class="math notranslate nohighlight">\(q\)</span> —Ç–∞–∫–æ–π, —á—Ç–æ <span class="math notranslate nohighlight">\(\hat{B}(q)\ket{0}\)</span> —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–æ–º, –±–ª–∏–∑–∫–∏–º –∫ –ø–µ—Ä–≤–æ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É –≤–µ–∫—Ç–æ—Ä—É <span class="math notranslate nohighlight">\(\hat{A}\)</span></p></li>
<li><p>–†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è <span class="math notranslate nohighlight">\(e\)</span>, –±–ª–∏–∑–∫–∏–π –∫ –ø–µ—Ä–≤–æ–º—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é <span class="math notranslate nohighlight">\(\hat{A}\)</span></p></li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section" id="id8">
<h2>–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é VQE<a class="headerlink" href="#id8" title="Permalink to this headline">¬∂</a></h2>
<p>–ò—Ç–∞–∫, –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ (<strong>T</strong>ravelling <strong>S</strong>alesman <strong>P</strong>roblem, –∏–ª–∏ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏ <strong>TSP</strong>). –ù–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–Ω–∞–Ω–∞, —Ç–∞–∫–∂–µ —Ä–∞—Å–ø–∏—Å–∞—Ç—å –ø–æ–ª–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä, –Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –≥—Ä–∞—Ñ, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –±—É–¥–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.</p>
<div class="section" id="id9">
<h3>–°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ<a class="headerlink" href="#id9" title="Permalink to this headline">¬∂</a></h3>
<p>–°–ª—É—á–∞–π–Ω—ã–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Å–ª—É—á–∞–π–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫—É—é:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–¢—É—Ç –º—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–∞—Ç—Ä–∏—Ü–µ–π –ø–æ–ª–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞, —Ç–æ –µ—Å—Ç—å —Ç–∞–∫–æ–≥–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–∞–∂–¥–æ–π. –≠—Ç–æ –≤–ø–æ–ª–Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –¥–æ–ø—É—â–µ–Ω–∏–µ –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞, —Ç–∞–∫ –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –†–§ –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤–æ –≤—Å–µ –¥—Ä—É–≥–∏–µ, –ø—É—Å—Ç—å –∏ –∑–∞ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rand_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>–¢–æ–ª—å–∫–æ —ç—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –∏ –∏–º–µ–µ—Ç –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏. –≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –æ–∑–Ω–∞—á–∞—é—Ç –ø–µ—Ç–ª–∏ (loop –∏–ª–∏ self-loop), —á—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ä–∞–∑—É–º–Ω–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞: –Ω–µ —è—Å–Ω–æ, —á—Ç–æ –∑–Ω–∞—á–∏—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Ç—å –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –ú–æ—Å–∫–≤—É. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏ –ø—Ä–æ —Ç–æ, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è: –µ—Å–ª–∏ –ø—É—Ç—å –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –∑–∞–π–º–µ—Ç 6 —á–∞—Å–æ–≤, —Ç–æ –∏ –ø—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ —Ç–æ–∂–µ –∑–∞–π–º–µ—Ç —Å—Ç–æ–ª—å–∫–æ –∂–µ. –¢–∞–∫ —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É. –î–∞–≤–∞–π—Ç–µ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏–º:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rand_adj</span> <span class="o">=</span> <span class="p">(</span><span class="n">rand_mat</span> <span class="o">+</span> <span class="n">rand_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">rand_adj</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù–∞–∫–æ–Ω–µ—Ü, —Å–¥–µ–ª–∞–µ–º –∏–∑ —ç—Ç–æ–≥–æ –≥—Ä–∞—Ñ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">rand_adj</span><span class="p">)</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">drawing</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">random_layout</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
<span class="n">edge_weights</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_weights</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tsp-networkx">
<h3>–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ TSP –≤ NetworkX<a class="headerlink" href="#tsp-networkx" title="Permalink to this headline">¬∂</a></h3>
<p>–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø–æ–Ω—è—Ç—å, —á—Ç–æ –º—ã –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª–∏, –¥–∞–≤–∞–π—Ç–µ —Å—Ä–∞–∑—É –Ω–∞–π–¥–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nx_solution</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">approximation</span><span class="o">.</span><span class="n">traveling_salesman_problem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">nx_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nx_solution</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">nx_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">nx_solution</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nx_solution</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NetworkX solution (nodes order):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nx_solution</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NetworkX solution (total cost): </span><span class="si">{</span><span class="n">nx_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sigma-z-mod">
<h3>–ú–∞—Ç—Ä–∏—Ü–∞ <span class="math notranslate nohighlight">\(\sigma^z_{mod}\)</span><a class="headerlink" href="#sigma-z-mod" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigma_z_mod</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">sz_mod</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">left_ith</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">k</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
    <span class="n">right_ith</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
        <span class="n">sparse</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">left_ith</span><span class="p">,</span> <span class="n">sz_mod</span><span class="p">),</span>
        <span class="n">right_ith</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ —ç—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è 0 –∏ 1, –≤ —á–µ–º –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —Å–æ–∑–¥–∞–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–∞–ª–µ–Ω—å–∫–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –≤—ã—á–∏—Å–ª–∏–≤ –≤—Å–µ –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">sigma_z_mod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>–õ–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –Ω–∞—à–µ–π <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span> —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ <span class="math notranslate nohighlight">\(\sigma^z\)</span>, –ø—Ä–∏—á–µ–º –æ–Ω–∏ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1, –∫–æ–≥–¥–∞ —Å–ø–∏–Ω —Å –Ω–æ–º–µ—Ä–æ–º 2 –∏–º–µ–µ—Ç –≤ –±–∏—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∑–Ω–∞—á–µ–Ω–∏–µ 0 –∏ 1 –µ—Å–ª–∏ –æ–Ω –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ —É –Ω–∞—Å 0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É <code class="docutils literal notranslate"><span class="pre">sigma_z_mod(1,</span> <span class="pre">3)</span></code> –∑–Ω–∞—á–∏—Ç —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞ ‚Äú–ø–æ—Å—Ç—Ä–æ–π –º–Ω–µ –º–∞—Ç—Ä–∏—Ü—É <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>, –¥–µ–π—Å—Ç–≤—É—é—â—É—é –Ω–∞ –≤—Ç–æ—Ä–æ–π —Å–ø–∏–Ω (–Ω—É –∏–ª–∏ –≤—Ç–æ—Ä–æ–π –∫—É–±–∏—Ç)‚Äù.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">psi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">psi</span> <span class="o">*</span> <span class="n">psi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
    <span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eigenvalue: </span><span class="si">{</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="s2">Bit string: </span><span class="si">{</span><span class="n">bit_s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–£–±–µ–¥–∏–º—Å—è —Ç–∞–∫–∂–µ –≤ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å –º–∞—Ç—Ä–∏—Ü–µ–π <span class="math notranslate nohighlight">\(\sigma^z\)</span>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–î–ª—è —á–∏—Å—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–µ–∑ –∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –≤–∏–¥—É –µ–¥–∏–Ω–∏—á–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü. –ò –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –∫–∞–∂–¥—ã–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ø–∏–Ω–æ–≤, –∞ –∑–Ω–∞—á–∏—Ç –µ–≥–æ –≤–æ–ª–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –≤–∏–¥ <span class="math notranslate nohighlight">\(\ket{\Psi} = \ket{0, 0, ..., 1, ..., 0, 0}\)</span>, –≥–¥–µ 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Ä–∞–∑ –Ω–æ–º–µ—Ä—É —Ç–æ–π –±–∏—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma z_mod:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma z:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">sigmaz_k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –¥–∞–∂–µ –µ—Å–ª–∏ —É –¥–≤—É—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞, —Ç–æ –∏—Ö –ø–æ—Ä—è–¥–æ–∫ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π) —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å–æ–≤—Å–µ–º –Ω–µ –æ–±—è–∑–∞–Ω. –í —ç—Ç–æ–º –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ <span class="math notranslate nohighlight">\(\hat{1}\)</span> –∏ <span class="math notranslate nohighlight">\(\hat{\sigma^z}\)</span> –≤ –Ω–∞—à–µ–º <span class="math notranslate nohighlight">\(\sigma^{z_{mod}}\)</span>. –ü–æ—ç—Ç–æ–º—É, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –≤ –±—É–¥—É—â–µ–º, –ª—É—á—à–µ –Ω–µ –ø—Ä–∏–≤—ã–∫–∞—Ç—å —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ <code class="docutils literal notranslate"><span class="pre">np.allclose</span></code>, –∞ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏—Ö –≥–ª–∞–∑–∞–º–∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.</p>
</div>
</div>
<div class="section" id="id10">
<h3>–ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω<a class="headerlink" href="#id10" title="Permalink to this headline">¬∂</a></h3>
<p>–î–∞–≤–∞–π—Ç–µ –µ—â–µ —Ä–∞–∑ –≤—ã–ø–∏—à–µ–º –ø–æ–ª–Ω—ã–π –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ <span class="math notranslate nohighlight">\(N^2\)</span> –∫—É–±–∏—Ç, –∫–æ—Ç–æ—Ä—ã–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –º—ã –≤—ã—Å—Ç—Ä–æ–∏–º –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã, –≥–¥–µ <span class="math notranslate nohighlight">\(i\)</span>-—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <span class="math notranslate nohighlight">\(i\)</span>-–º—É —à–∞–≥—É –≤ —Ü–∏–∫–ª–µ –ø–æ –≥—Ä–∞—Ñ—É, –∞ <span class="math notranslate nohighlight">\(j\)</span>-–π —ç–ª–µ–º–µ–Ω—Ç —Å—Ç—Ä–æ–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–º–µ—Ä—É –≤–µ—Ä—à–∏–Ω—ã –∏ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—à–∏–º –±–∏–Ω–∞—Ä–Ω—ã–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º:</p>
<div class="math notranslate nohighlight">
\[
\hat{H} = a\sum_{i=1}^N (1 - \sum_{j=1}^N \sigma^{z_{mod}}_{i,j})^2 + a\sum_{j=1}^N (1 - \sum_{i=1}^N \sigma^{z_{mod}}_{i,j})^2 + a \sum_{u,v \not\in E}\sum_{j=1}^{N-1}\sigma^{z_{mod}}_{u,j}\sigma^{z_{mod}}_{v,j+1} + b \sum_{u,v \in E}\sum_{j=1}^{N-1}\sigma^{z_{mod}}_{u,j}\sigma^{z_{mod}}_{v,j+1}
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>–ï—â–µ —Ä–∞–∑ –≤—Å–ø–æ–º–Ω–∏–º, —á—Ç–æ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Å–ª–∞–≥–∞–µ–º—ã—Ö –≥–æ–≤–æ—Ä—è—Ç –Ω–∞–º, —á—Ç–æ –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—Ö–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü, –∞ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –≤–µ—Ä—à–∏–Ω—É. –¢—Ä–µ—Ç—å–µ —Å–ª–∞–≥–∞–µ–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —à—Ç—Ä–∞—Ñ –∑–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω, –º–µ–∂–¥—É –∫–æ—Ç–æ—Ä—ã–º–∏ –Ω–µ—Ç —Ä–µ–±—Ä–∞, –∞ —á–µ—Ç–≤–µ—Ä—Ç–æ–µ –¥–∞–µ—Ç –Ω–∞–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ–≥–æ –ø—É—Ç–∏. –ü–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å–ª–∞–≥–∞–µ–º—ã—Ö –∏–¥—É—Ç —Å –±–û–ª—å—à–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º, —á–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –≤–∞–∂–Ω–æ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç—å —Å–∞–º–æ–µ –¥–µ—à–µ–≤–æ–µ.</p>
</div>
<p>–ù–æ –º—ã —Å–¥–µ–ª–∞–µ–º –µ—â–µ –æ–¥–∏–Ω –Ω–µ–±–æ–ª—å—à–æ–π —Ñ–∏–Ω—Ç. –ú—ã –±—É–¥–µ–º –≤—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø—É—Ç—å –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤ –≤–µ—Ä—à–∏–Ω–µ —Å –∏–Ω–¥–µ–∫—Å–æ–º 0. –¢–∞–∫ –∫–∞–∫ –ø—É—Ç—å –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —ç—Ç–æ –≥–∞–º–∏–ª—å—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª, —Ç–æ –º—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ —É–ø—Ä–æ—â–µ–Ω–∏–µ –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–æ—Ç–µ—Ä–∏ –æ–±—â–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –≤–µ—Ä—à–∏–Ω–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º 0 –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—É–¥–µ—Ç –≤–æ–π—Ç–∏ –≤ –ø—É—Ç—å. –ü—Ä–∏ —ç—Ç–æ–º —Ç–∞–∫–æ–π —Ö–∏—Ç—Ä—ã–π —Ç—Ä—é–∫ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º —Å–Ω–∏–∑–∏—Ç—å —á–∏—Å–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫—É–±–∏—Ç —Å <span class="math notranslate nohighlight">\(N^2\)</span> –¥–æ <span class="math notranslate nohighlight">\((N - 1)^2\)</span>, —á—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ (—Ö–æ—Ç—è –∞—Å—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–æ–π –∂–µ). –†–∞–±–æ—Ç–∞—Ç—å —Å –≥—Ä–∞—Ñ–æ–º –º—ã –±—É–¥–µ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ —É–∂–µ –∑–Ω–∞–∫–æ–º–æ–π –Ω–∞–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_tsp_to_ising</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">:</span>
    <span class="c1"># –£ –Ω–∞—Å –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞:</span>
    <span class="c1">#   - —á–∞—Å—Ç—å, –¥–∞—é—â–∞—è –Ω–∞–º –ì–∞–º–∏–ª—Ç–æ–Ω–æ–≤ —Ü–∏–∫–ª</span>
    <span class="c1">#   - —á–∞—Å—Ç—å, —Å—á–∏—Ç–∞—é—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏</span>
    <span class="c1"># –î–ª—è –Ω–∞—Å –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –≤–µ—Å –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø—Ä–µ–≤–∞–ª–∏—Ä–≤–∞–ª.</span>
    <span class="c1"># –ü–æ—ç—Ç–æ–º—É, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –º—ã –±–µ—Ä–µ–º</span>
    <span class="c1"># –ø—è—Ç–∏–∫—Ä–∞—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞ —Ä–µ–±–µ—Ä –≤ –≥—Ä–∞—Ñ–µ.</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">max</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

    <span class="c1"># –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º:</span>
    <span class="c1">#   - –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–µ —Å—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω —Ä–∞–∑</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="c1"># –°—á–∏—Ç–∞–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ 1 - sum</span>
        <span class="n">col_sum</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">col_sum</span> <span class="o">-=</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># –í–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≥–∞–º–∏–ª—Ç–æ–Ω–∏–∞–Ω—É</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">col_sum</span> <span class="o">*</span> <span class="n">col_sum</span>

    <span class="c1"># –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É –ø–æ —Å—Ç—Ä–æ–∫–∞–º:</span>
    <span class="c1">#   - –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ —Å—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω —Ä–∞–∑</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">row_sum</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;coo&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">row_sum</span> <span class="o">-=</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">row_sum</span> <span class="o">*</span> <span class="n">row_sum</span>

    <span class="c1"># –°—á–∏—Ç–∞–µ–º —Å—É–º–º—É –ø–æ —Ç–µ–º —Ä–µ–±—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã—Ö –≤ –≥—Ä–∞—Ñ–µ –Ω–µ—Ç –∏ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># –°—É–º–º–∞ –ø–æ –≤—Å–µ–º —Ä–µ–±—Ä–∞–º –≥—Ä–∞—Ñ–∞</span>
                <span class="n">coef</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –°—É–º–º–∞ –ø–æ –≤—Å–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º —Ä–µ–±—Ä–∞–º –≥—Ä–∞—Ñ–∞</span>
                <span class="n">coef</span> <span class="o">=</span> <span class="n">a</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># –î–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏ —Å—á–∏—Ç–∞–µ–º —Å—É–º–º—É</span>
                <span class="n">H</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">coef</span>
                    <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">H</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">coef</span>
                <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># –ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ–º –∏–∑ –Ω—É–ª–µ–≤–æ–π –≤–µ—Ä—à–∏–Ω—ã, —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —Å–Ω–∏–∑–∏—Ç—å —á–∏—Å–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫—É–±–∏—Ç–æ–≤.</span>
    <span class="c1"># –ù–æ —Ç–µ–ø–µ—Ä—å –º—ã –¥–æ–ª–∂–Ω—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–ª–∞–≥–∞–µ–º–æ–µ, –æ—Ç–≤–µ—á–∞—é—â–µ–µ –∑–∞ –Ω—É–ª–µ–≤—É—é –≤–µ—Ä—à–∏–Ω—É –≤ –ø—É—Ç–∏.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coef</span> <span class="o">=</span> <span class="n">a</span>

        <span class="n">H</span> <span class="o">+=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">+=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">sigma_z_mod</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># PennyLane —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—Ç—Ä–∏—Ü–∞–º–∏ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –ø–æ—ç—Ç–æ–º—É —Å—Ä–∞–∑—É –¥–µ–ª–∞–µ–º –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ.</span>
    <span class="k">return</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ —Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–∞—Å—Ç –Ω–∞–º —Ç–æ—Ç –∂–µ –ø—É—Ç—å (—Å —Ç–æ–π –∂–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é), —á—Ç–æ –∏ —Ä–µ—à–µ–Ω–∏–µ –∏–∑ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">op</span> <span class="o">=</span> <span class="n">convert_tsp_to_ising</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">scipy_solution</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SR&quot;</span><span class="p">,</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground state energy: </span><span class="si">{</span><span class="n">scipy_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">probs</span> <span class="o">=</span> <span class="n">scipy_solution</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">scipy_solution</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
<span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># –ù—É–ª–µ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–∞—è</span>
<span class="n">scipy_path</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit_s</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">scipy_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">scipy_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">scipy_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scipy_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">scipy_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">scipy_path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">scipy_path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SciPy solution (nodes order):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scipy_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy solution (total cost): </span><span class="si">{</span><span class="n">scipy_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—Ü—É —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –Ω–∞–º –≤—ã–¥–∞–ª <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code> (—Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –∏–Ω–≤–µ—Ä—Å–∏–∏: <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2,</span> <span class="pre">1,</span> <span class="pre">3,</span> <span class="pre">0]</span></code> –∏ <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">0]</span></code>), –∫–∞–∫ –∏ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏. –≠–Ω–µ—Ä–≥–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ø–æ –ø—Ä–∏—á–∏–Ω–µ —Ç–æ–≥–æ, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏ –º–∞–≥–∏—é —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏. –ù–æ —ç—Ç–æ –Ω–∞–º –Ω–µ –≤–∞–∂–Ω–æ: –ø–æ —ç–Ω–µ—Ä–≥–∏—è–º –Ω–∞–º –≤–∞–∂–Ω–æ –ª–∏—à—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–Ω–∞—è –±–∏—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –º—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É—Ç–∏ –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è!</p>
<p>–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ, –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ —Å–∏–º—É–ª—è—Ü–∏–∏ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π!</p>
<div class="section" id="vqe-pennylane">
<h4>VQE –Ω–∞ Pennylane<a class="headerlink" href="#vqe-pennylane" title="Permalink to this headline">¬∂</a></h4>
<p>–î–ª—è –Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞—à—É –º–∞—Ç—Ä–∏—Ü—É –∫ —Ç–æ–º—É –æ–±—ä–µ–∫—Ç—É, —Å –∫–æ—Ç–æ—Ä—ã–º —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞—à –∫–≤–∞–Ω—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">Pennylane</span></code> –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç—É —Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–æ–≤ –≤ –≤–∏–¥–µ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã—Ö –ü–∞—É–ª–∏-—Å—Ç—Ä–æ–∫, –Ω–æ —Ç—É—Ç –º—ã –Ω–µ –±—É–¥–µ–º –µ—â–µ —Ä–∞–∑ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–µ—Å—å –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω, –∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ä–∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—à—É —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É.</p>
</div>
<p>–í–µ—Å–∞ –Ω–∞—à–µ–≥–æ –≥—Ä–∞—Ñ–∞ –∏–º–µ—é—Ç —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π –æ—Ç 0 –¥–æ 100. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ, –ø—Ä–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∞—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞, –≤–ø–ª–æ—Ç—å –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç—ã—Å—è—á. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –º–µ—Ç–æ–¥–æ–º <code class="docutils literal notranslate"><span class="pre">paramter-shift</span></code>, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –¥–∞–≤–∞–π—Ç–µ —É–º–Ω–æ–∂–∏–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –Ω–∞ <span class="math notranslate nohighlight">\(0.1\)</span>. –≠—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ –∏ —É–ª—É—á—à–∏—Ç —á–∏—Å–ª–µ–Ω–Ω—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å. –î–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ —á–∏—Å–ª–µ–Ω–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ, –∞ –≤–∞–∂–Ω–æ –ª–∏—à—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>

<span class="n">numer_stability_const</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">SparseHamiltonian</span><span class="p">(</span><span class="n">op</span> <span class="o">*</span> <span class="n">numer_stability_const</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>–î–∞–ª–µ–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å <em>ansatz</em>. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –≤–∏–¥ —Ä–µ—à–µ—Ç–∫–∏, —Ç–∏–ø–∞ —Ç–∞–∫–æ–≥–æ:</p>
<div class="figure align-default" id="sycamore-lattice">
<a class="reference internal image-reference" href="../../_images/sycamore.png"><img alt="../../_images/sycamore.png" src="../../_images/sycamore.png" style="width: 350px;" /></a>
<p class="caption"><span class="caption-number">Fig. 99 </span><span class="caption-text">–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ <em>Sycamore</em> –æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ <em>Google</em> <span id="id11">[<a class="reference internal" href="../bibliography.html#id29"><span>AAB+19</span></a>]</span></span><a class="headerlink" href="#sycamore-lattice" title="Permalink to this image">¬∂</a></p>
</div>
<p>–ü–æ—ç—Ç–æ–º—É –Ω–∞–º, –≤ –∏–¥–µ–∞–ª–µ, —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –¥–µ–ª–∞—Ç—å –ª–∏–±–æ –æ–¥–Ω–æ–∫—É–±–∏—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ª–∏–±–æ –¥–≤—É—Ö–∫—É–±–∏—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–æ –Ω–∞–¥ ‚Äú—Å–æ—Å–µ–¥–Ω–∏–º–∏‚Äù –∫—É–±–∏—Ç–∞–º–∏. –¢–∞–∫ –ø–æ—è–≤–∏–ª–∞—Å—å –∏–¥–µ—è <em>hardware efficient ansatz</em> <span id="id12">[<a class="reference internal" href="../bibliography.html#id18"><span>KMT+17</span></a>]</span>. –û–Ω –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –º—ã —Ñ–æ—Ä–º–∏—Ä—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äú—Å–ª–æ–µ–≤‚Äù –Ω–∞—à–µ–π <strong>VQC</strong>, –∫–∞–∂–¥—ã–π —Å–ª–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—Ä–∞—â–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –ø–æ–ø–∞—Ä–Ω—ã–µ ‚Äú–∑–∞–ø—É—Ç—ã–≤–∞—é—â–∏–µ‚Äù –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <a class="reference external" href="../qcblock/gates.html#cy-cz"><em>CZ</em></a>, –∏–ª–∏ –≥–µ–π—Ç <a class="reference external" href="../qcblock/gates.html#cnot-cx"><em>CNOT</em></a>). –í—ã–≥–ª—è–¥–∏—Ç —ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</p>
<div class="figure align-default" id="id15">
<a class="reference internal image-reference" href="../../_images/HWA.png"><img alt="../../_images/HWA.png" src="../../_images/HWA.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 100 </span><span class="caption-text">–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è <em>hardware efficient ansatz</em> (<em>HWEA</em>) –∏–∑ <span id="id13">[<a class="reference internal" href="../bibliography.html#id18"><span>KMT+17</span></a>]</span></span><a class="headerlink" href="#id15" title="Permalink to this image">¬∂</a></p>
</div>
<p>–î–∞–≤–∞–π—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ–º —Ç–∞–∫–æ–π —Å–ª–æ–π:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ham</span><span class="o">.</span><span class="n">wires</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">layer</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>–ó–¥–µ—Å—å –º—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ–º –æ—Å–Ω–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å—Ö–µ–º. –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∑–∞–±—ã–ª, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ <a class="reference internal" href="../vqcblock/vqc.html#vqc"><span class="std std-ref">–æ—Ç–¥–µ–ª—å–Ω–æ–π –ª–µ–∫—Ü–∏–∏</span></a> –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ.</p>
<p>–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –Ω–∞—à–∏–º –∫–≤–∞–Ω—Ç–æ–≤—ã–º —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–º, –∞ —Ç–∞–∫–∂–µ –Ω–∞–ø–∏—à–µ–º –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è. –¢–∞–∫–æ–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞—à–∏—Ö <em>HWEA</em> —Å–ª–æ–µ–≤, –ø–æ—Å–ª–µ —á–µ–≥–æ –∏–∑–º–µ—Ä–∏—Ç—å –æ–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω–∞ –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="n">num_layers</span> <span class="o">=</span> <span class="mi">3</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="s2">&quot;parameter-shift&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">feed_forward</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">layer</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">qml</span><span class="o">.</span><span class="n">expval</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω–∞–¥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≤—ã–±—Ä–∞—Ç—å –º–µ—Ç–æ–¥ –∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –í —ç—Ç–æ—Ç —Ä–∞–∑ –¥–∞–≤–∞–π—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º <code class="docutils literal notranslate"><span class="pre">Momentum</span></code>, —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–º ‚Äú—É—Å–∫–æ—Ä–µ–Ω–Ω—ã–º‚Äù –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º —Å–ø—É—Å–∫–æ–º:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">MomentumOptimizer</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
    <span class="nb">tuple</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–ù—É –∏ –Ω–∞–∫–æ–Ω–µ—Ü –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í—Å–µ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∂–µ, –∫–∞–∫ –≤ <a class="reference internal" href="../gradsblock/gradients.html#gradients"><span class="std std-ref">–±–∞–∑–æ–≤–æ–π –ª–µ–∫—Ü–∏–∏ –ø—Ä–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã</span></a>. –¢–æ –µ—Å—Ç—å –Ω–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ –º—ã —Ç—É—Ç –ø–æ —Å—É—Ç–∏ –Ω–µ –¥–µ–ª–∞–µ–º.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç, —Ç–∞–∫ –∫–∞–∫ –º—ã –æ–±—É—á–∞–µ–º –¥–æ–≤–æ–ª—å–Ω–æ —Ç—è–∂–µ–ª—É—é —Å—Ö–µ–º—É –Ω–∞ 9-–∏ –∫—É–±–∏—Ç–∞—Ö!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">feed_forward</span><span class="p">(</span><span class="n">params</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">params</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">step_and_cost</span><span class="p">(</span><span class="n">feed_forward</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="se">\t</span><span class="s2">energy: </span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energy</span><span class="p">)),</span> <span class="n">energy</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Energy by epochs&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">scipy_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">numer_stability_const</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">energy</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>–í–∏–¥–∏–º, —á—Ç–æ –Ω–∞—à <strong>VQE</strong> –æ—Ç–ª–∏—á–Ω–æ —Å—Ö–æ–¥–∏—Ç—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –∑–Ω–∞–µ–º –∏–∑ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> –∏ <code class="docutils literal notranslate"><span class="pre">ARPACK</span></code>. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–≤–∞–Ω—Ç–æ–≤—ã–π –ø—É—Ç—å —Å–æ–≤–ø–∞–¥–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –∏–∑ <code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –±–∏—Ç–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫. –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ—Ä—è—è –º–Ω–æ–≥–æ —Ä–∞–∑, –Ω–æ –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ —Å—Ä–∞–∑—É –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="s2">&quot;parameter-shift&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">answer</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
        <span class="n">layer</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">qml</span><span class="o">.</span><span class="n">probs</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>

<span class="n">probs</span> <span class="o">=</span> <span class="n">answer</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">bit_s</span> <span class="o">=</span> <span class="n">probs2bit_str</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># –ù—É–ª–µ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–∞—è</span>
<span class="n">q_path</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit_s</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">q_solution_cost</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">q_solution_cost</span> <span class="o">+=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_edge_data</span><span class="p">(</span><span class="n">q_path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">q_path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantum solution (nodes order):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quantum solution (total cost): </span><span class="si">{</span><span class="n">q_solution_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>–£—Ä–∞, —É –Ω–∞—Å –ø–æ–ª—É—á–∏–ª—Å—è —Ç–æ—Ç –∂–µ –æ—Ç–≤–µ—Ç, —á—Ç–æ –∏ –≤ <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>/<code class="docutils literal notranslate"><span class="pre">NetworkX</span></code>. –ó–Ω–∞—á–∏—Ç –Ω–∞—à —Å–∞–º–æ–ø–∏—Å–Ω—ã–π <strong>VQE</strong> —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.</p>
</div>
</div>
</div>
<div class="section" id="id14">
<h2>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ<a class="headerlink" href="#id14" title="Permalink to this headline">¬∂</a></h2>
<p>–í –±—É–¥—É—â–µ–º –≤–∞–º –≤—Ä—è–¥ –ª–∏ –ø—Ä–∏–¥–µ—Ç—Å—è —Å–∞–º–∏–º —Ä–∞—Å–ø–∏—Å—ã–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã –∏ —Å—Ç—Ä–æ–∏—Ç—å –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω—ã, —Ç–∞–∫ –∫–∞–∫ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä—É—Ç–∏–Ω—ã –¥–ª—è —Å–∞–º—ã—Ö —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–æ–≥–æ, –∫–∞–∫ <strong>VQE</strong> —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏, –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã–ª–æ –ø—Ä–æ–¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤—Å–µ –æ—Ç –Ω–∞—á–∞–ª–∞ –∏ –¥–æ –∫–æ–Ω—Ü–∞ —Å–∞–º–∏–º. –ù–∞–¥–µ—é—Å—å, –≤–∞–º –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/vqeblock"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="vqeintro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">–û –±–ª–æ–∫–µ</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="tspvqe.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–æ–º–º–∏–≤–æ—è–∂–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é VQE</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By ODS Quantum Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-51362752-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>